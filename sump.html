<!DOCTYPE html>
<html lang="en">
<head>
<meta name="robots" content="noindex, nofollow, noarchive">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Truck Load Optimizer</title>

<style>
:root { --primary:#2563eb; --bg:#f8fafc; --card:#fff; --border:#e2e8f0; --text:#1e293b; }
body { font-family: system-ui, sans-serif; background: var(--bg); color: var(--text); padding:2rem; max-width:1200px; margin:auto; }
h1 { color:var(--primary); }
.subtitle { color:#64748b; margin-bottom:1.5rem; }

.container { display:grid; grid-template-columns:360px 1fr; gap:2rem; }
@media(max-width:800px){ .container{grid-template-columns:1fr;} }

.panel { background:var(--card); border:1px solid var(--border); border-radius:8px; padding:1.5rem; }
label { font-weight:600; font-size:0.9rem; display:block; margin-top:0.75rem; }

textarea { width:100%; height:110px; font-family:monospace; font-size:0.85rem; padding:0.5rem; border:1px solid var(--border); border-radius:4px; }

select, button { width:100%; margin-top:1rem; padding:0.75rem; font-weight:600; border-radius:6px; }
button { background:var(--primary); color:white; border:none; cursor:pointer; }
button:hover { opacity:0.9; }

.truck-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(320px,1fr)); gap:1.5rem; }
.truck-card { border:1px solid var(--border); border-radius:8px; background:var(--card); }
.truck-header { padding:1rem; background:#f1f5f9; border-bottom:1px solid var(--border); }
.stats { display:flex; gap:1rem; font-size:0.9rem; margin-bottom:0.5rem; }
.stat span:first-child { font-size:0.7rem; color:#64748b; text-transform:uppercase; display:block; }
.stat span:last-child { font-weight:600; }

.tp-list {
    font-size:0.8rem;
    background:#f8fafc;
    border:1px solid var(--border);
    padding:0.5rem;
    border-radius:4px;
    white-space:pre-wrap;
    font-family:monospace;
}

.status { display:inline-block; padding:0.4rem 0.8rem; border-radius:99px; font-size:0.8rem; font-weight:600; margin-bottom:1rem; }
.ok { background:#dcfce7; color:#166534; }
</style>
</head>

<body>

<h1>Truck Load Optimizer</h1>
<p class="subtitle">Higher TP Count → Lower m³</p>

<div class="container">

<!-- INPUT -->
<div class="panel">

<label>Transport Numbers (space separated)</label>
<textarea id="tpInput"></textarea>

<label>m³ (space separated)</label>
<textarea id="m3Input"></textarea>

<label>Weight KG (European format)</label>
<textarea id="kgInput"></textarea>

<label>Number of Trucks</label>
<select id="truckCount">
<option value="2">2 Trucks</option>
<option value="3">3 Trucks</option>
<option value="4">4 Trucks</option>
<option value="5">5 Trucks</option>
</select>

<button onclick="runOptimization()">Calculate Layout</button>
</div>

<!-- OUTPUT -->
<div id="outputArea">
<div class="panel" style="text-align:center;color:#94a3b8;">Results will appear here</div>
</div>

</div>

<script>
// ---------- HELPERS ----------
function parseEuroNumber(v) {
    return parseFloat(
        v.replace(/\./g,'').replace(',','.')
    );
}

function collectItems() {
    const tp = tpInput.value.trim().split(/\s+/);
    const m3 = m3Input.value.trim().split(/\s+/);
    const kg = kgInput.value.trim().split(/\s+/);

    if (![m3.length, kg.length].every(l => l === tp.length)) {
        alert("TP, m³ and KG counts must match");
        return [];
    }

    return tp.map((_,i)=>({
        tp: tp[i],
        m3: parseEuroNumber(m3[i]),
        kg: parseEuroNumber(kg[i])
    }));
}

// ---------- MAIN ----------
function runOptimization() {
    const items = collectItems();
    if (!items.length) return;

    const tpGroups = groupItemsByTP(items);
    const trucks = calculateTrucks(tpGroups, parseInt(truckCount.value));
    renderResults(trucks);
}

// ---------- GROUPING ----------
function groupItemsByTP(items) {
    const map = new Map();
    items.forEach(i=>{
        if(!map.has(i.tp))
            map.set(i.tp,{tp:i.tp,kg:0,m3:0,tpCount:1});
        const g=map.get(i.tp);
        g.kg+=i.kg;
        g.m3+=i.m3;
    });
    return [...map.values()];
}

// ---------- OPTIMIZER ----------
function calculateTrucks(blocks,n) {
    const trucks=Array.from({length:n},(_,i)=>({
        id:i+1,kg:0,m3:0,tpCount:0,blocks:[]
    }));

    // largest volumes first
    blocks.sort((a,b)=>b.m3-a.m3);

    blocks.forEach(b=>{
        trucks.sort((a,b)=>a.m3-b.m3);
        const t=trucks[0];
        t.blocks.push(b);
        t.kg+=b.kg;
        t.m3+=b.m3;
        t.tpCount+=b.tpCount;
    });

    return trucks;
}

// ---------- RENDER ----------
function renderResults(trucks) {
    let html=`<div class="truck-grid">`;

    trucks.forEach(t=>{
        const tpList = t.blocks.map(b=>b.tp).join('\n');

        html+=`
        <div class="truck-card">
        <div class="truck-header">
            <strong>Truck ${t.id}</strong>
            <div class="stats">
                <div class="stat"><span>TP Count</span><span>${t.blocks.length}</span></div>
                <div class="stat"><span>m³</span><span>${t.m3.toFixed(2)}</span></div>
                <div class="stat"><span>KG</span><span>${t.kg.toFixed(0)}</span></div>
            </div>
            <div class="tp-list">${tpList}</div>
        </div>
        </div>`;
    });

    outputArea.innerHTML=html+"</div>";
}
</script>

</body>
</html>
